[gd_scene load_steps=3 format=2]

[ext_resource path="res://battle/pics/theSun.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]

script/source = "extends \"../scripts/actor.gd\"

onready var yellow = preload(\"res://battle/objects/yellowBullet.tscn\")
onready var red = preload(\"res://battle/objects/redBullet.tscn\")
onready var player = get_node(\"../player\")


func _ready():
	addRoutine(\"flirt1\")
	addRoutine(\"waves\")


func flirt1():
	health = 120
	var width = 10
	var tick = createTimer(0.4)
	var angle = PI
	
	while (true):
		var pos = Vector2(0,0)
		for i in range(width):
			angle += 0.5
			if (fmod(angle,PI * 2) < PI): angle -= PI
			pos.x = bounds.position.x + bounds.size.x / width * i
			shootFrom(yellow,DOWN,pos,70).gravify(angle,10)
		yield(tick.r(),T)
		health -= 1
		if (isDone()): return


func flirt2():
	health = 120
	var width = 10
	var tick = createTimer(0.2)
	var angle = 0
	
	while (true):
		var pos = Vector2(0,0)
		for i in range(width):
			angle += 0.7
			pos.x = bounds.position.x + bounds.size.x / width * i
			shootFrom(yellow,DOWN,pos,70).gravify(angle,10)
		yield(tick.r(),T)
		if (isDone()): return

	
	
func waves():
	health = 120
	var width = 10
	var tick = createTimer(0.14)
	var angle = 0
	
	while (true):
		var pos = Vector2(0,0)
		for i in range(width):
			angle += 0.15
			pos.x = bounds.position.x + bounds.size.x / width * i
			shootFrom(yellow,DOWN,pos).gravify(angle,150)
		pos.x = player.position.x
		shootFrom(red,DOWN,pos).gravify(angle,150)
		yield(tick.r(),T)
		
		if (isDone()): return"

[node name="theSun" type="Sprite"]

position = Vector2( -5.9596, -10.7181 )
texture = ExtResource( 1 )
offset = Vector2( 5.9596, 10.7181 )
script = SubResource( 1 )
_sections_unfolded = [ "Material" ]
flippy = false
walky = false
target = true
speed = 100

[node name="hitbox" type="Area2D" parent="." index="0"]

visible = false
use_parent_material = true
position = Vector2( 5.9596, 10.7181 )
input_pickable = true
gravity_vec = Vector2( 0, 1 )
gravity = 98.0
linear_damp = 0.1
angular_damp = 1.0
audio_bus_override = false
audio_bus_name = "Master"

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="hitbox" index="0"]

show_behind_parent = true
build_mode = 0
polygon = PoolVector2Array( -88.4636, 68.2862, 96.7245, 69.0611, 58.176, 51.4333, 85.8767, -22.177, 59.1445, -67.6992, -59.7943, -39.2236, -56.8886, -10.9418, 36.2866, 34.5804, -93.3064, 44.6534 )


